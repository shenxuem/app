# 第三方设备（标准MQTT协议）接入明牛云

## 1. 【第三方设备】相关设置

### 1.1 批建设备

点击【第三方设备接入】——批建设备——输入批建设备数量  
- 所属协议：标准MQTT  
- 设备来源：设备输入  
- 设备ID:设备ID  
以下是操作步骤：  
新建1台  

![avatar](/assets/img/1.gif)  
新建多台，比如2台；  

![avatar](/assets/img/2.gif) 

### 1.2 查看设备基本信息 

点击设备名称——【基本信息】，可以查看设备的详细信息，其中 “mqtt 主机名”，“mqtt端口号”，“mqtt clientId”，“mqtt username”，“mqtt password” 要填入第三方硬件MQTT设置中。  
- 若MQTT 通讯正常，设备状态变为“在线”；   
- 若MQTT 通讯异常，设备状态变为“离线”；
    
![avatar](/assets/img/3.png)

设备秘钥也可修改，详见以下视频

![avatar](/assets/img/4.gif)

### 1.3 添加变量

（1）手动方式  
进入【第三方设备】-点击设备-【变量列表】-新建变量，弹出新建变量列表，名称为第三方MQTT变量名称，数据类型，读写类型和第三方硬件MQTT保持一致。  比如第三方硬件中MQTT名称有 tag1,16位有符号，可读可写类型；  
存储方式：默认不存储,可设置：周期存/assets/img/变化存/assets/img/条件存储。

![avatar](/assets/img/5.gif)  
- 周期存储：可设置1分钟/5分钟/10分钟/30分钟/60分钟存储一次。   
  
![avatar](/assets/img/6.png)  
- 变化存储：需要设置波动的上下限。当数值变化范围在上下限之间，存储一次数据。  
  
![avatar](/assets/img/7.png)    
- 条件存储：当满足条件后，数据存储一次。 
   
![avatar](/assets/img/8.png)  
（2）导入导出方式  

- 导出变量
  
![avatar](/assets/img/9.gif)
- 导入变量
  
![avatar](/assets/img/10.gif)

### 1.4 修改变量

![avatar](/assets/img/11.png)

### 1.5 删除变量

![avatar](/assets/img/12.png)

### 1.6 变量写值

![avatar](/assets/img/13.gif)

### 1.7 分组设置

点击【分组设置】——【新建分组】，在弹出的窗口里输入分组名称。

![avatar](/assets/img/14.gif)

### 1.8 添加报警

![avatar](/assets/img/15.gif)

- 报警名称：自定义。  
- 报警详情：自定义。  
- 所属变量：勾选【变量列表】中添加的变量。  
- 报警规则：可设置>=、<等规则    
- 严重性：分为一般的，重要的，紧急的。  
- 确认规则：  
（1）手动确认：报警触发后需要手动确认。  
（2）报警恢复后才能手动确认：报警没恢复前不能点“确认”，恢复后可以点击“确认”。  
（3）报警恢复自动确认：报警恢复后自动确认，不需要再手动点“确认”。  
- 延迟推送：比如设置10s,那么报警持续时间大于10s，才推送报警消息；如果报警时间小于10s,那么此报警不会推送。  
- 报警恢复消息：自定义。

### 1.9 查看日志

![avatar](/assets/img/16.png)

## 2. 【项目中心】  

### 2.1 添加项目

进入【项目中心】——【新建项目】  
项目名称：自定义  
设备来源：第三方设备  

![avatar](/assets/img/17.gif)

### 2.2 添加设备

进入【项目中心】——选择项目——【项目配置】，点击“绑定设备”弹出【添加设备】的页面，此页面出现的设备均为第三方设备里添加的设备并且没有被其他项目绑定过；选择相应设备后点击“保存”。

![avatar](/assets/img/18.gif)

### 2.3 查看实时数据

进入【项目中心】——【数据监控】——【实时数据】

![avatar](/assets/img/19.png)

### 2.4 查看报警

当报警触发发后，在【项目中心】——【报警监控】——【活跃报警】/【全部报警】里可以看到报警信息.

![avatar](/assets/img/20.png)

### 2.5 组态设计

![avatar](/assets/img/21.gif)
